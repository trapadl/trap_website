import{s as i,l,b as y,i as h,a as v}from"./countdown-1B-LzVIm.js";async function p(){const e=document.querySelectorAll(".auth-tab"),t=document.querySelectorAll(".auth-form"),r=await y.getCurrentUser();r&&d(r),e==null||e.forEach(a=>{a.addEventListener("click",()=>{var c;const s=a.dataset.form;e.forEach(u=>u.classList.remove("active")),t.forEach(u=>u.classList.remove("active")),a.classList.add("active"),(c=document.getElementById(`${s}-form`))==null||c.classList.add("active")})});const o=document.getElementById("signin-form"),n=document.getElementById("signup-form");o==null||o.addEventListener("submit",g),n==null||n.addEventListener("submit",w)}async function g(e){e.preventDefault();const t=e.target,r=t.querySelector('input[type="email"]').value,o=t.querySelector('input[type="password"]').value;try{const{data:n,error:a}=await i.auth.signInWithPassword({email:r,password:o});if(a)throw a;n.user&&(d(n.user),window.location.href="/")}catch(n){l(n),m(t,n.message)}}async function w(e){e.preventDefault();const t=e.target,r=t.querySelector('input[type="text"]').value,o=t.querySelector('input[type="email"]').value,n=t.querySelector('input[type="password"]').value;try{const{data:a,error:s}=await i.auth.signUp({email:o,password:n,options:{data:{full_name:r,role:"bartender"}}});if(s)throw s;if(a.user){const{error:c}=await i.from("bartenders").insert([{user_id:a.user.id,full_name:r,rating:1500}]);if(c)throw c;E(t,"Account created successfully! Please check your email for verification.")}}catch(a){l(a),m(t,a.message)}}function d(e){const t=document.querySelector(".auth-container");t&&(t.innerHTML=`
      <div class="profile-summary">
        <h2>Welcome, ${e.user_metadata.full_name||"User"}</h2>
        <button onclick="handleSignOut()" class="submit-button">Sign Out</button>
      </div>
    `)}function m(e,t){const r=e.querySelector(".form-error")||f(e,"form-error");r.textContent=t}function E(e,t){const r=e.querySelector(".form-success")||f(e,"form-success");r.textContent=t}function f(e,t){const r=document.createElement("div");return r.className=t,e.appendChild(r),r}window.handleSignOut=async function(){try{const{error:e}=await i.auth.signOut();if(e)throw e;window.location.href="/enter"}catch(e){l(e),alert("Error signing out. Please try again.")}};document.addEventListener("DOMContentLoaded",()=>{h(),v(),p()});function S(){const e=document.querySelectorAll(".auth-tab"),t=document.querySelectorAll(".auth-form"),r=document.querySelector('select[name="role"]'),o=document.querySelector(".bartender-fields"),n=document.querySelector(".organiser-fields");e.forEach(a=>{a.addEventListener("click",()=>{e.forEach(s=>s.classList.remove("active")),t.forEach(s=>s.classList.remove("active")),a.classList.add("active"),document.getElementById(`${a.dataset.form}-form`).classList.add("active")})}),r==null||r.addEventListener("change",a=>{a.target.value==="bartender"?(o.style.display="block",n.style.display="none"):(o.style.display="none",n.style.display="block")})}S();
